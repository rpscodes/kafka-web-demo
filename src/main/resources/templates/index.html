<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Kafka Web Demo</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="heading">Kafka Conveyor Demo ¬∑ Key-based Routing</h1>
            <div class="controls">
                <div class="speed-control">
                    <label>Speed</label>
                    <input type="range" id="speedSlider" min="0.1" max="3" step="0.1" value="1.0" class="speed-slider">
                    <span id="speedValue">1.0x</span>
                </div>
                <div class="quick-send-group">
                    <span class="quick-send-label">Quick Send:</span>
                    <button onclick="bulk(5)" class="quick-send-btn">5</button>
                    <button onclick="bulk(10)" class="quick-send-btn">10</button>
                    <button onclick="bulk(30)" class="quick-send-btn">30</button>
                    <button onclick="bulk(50)" class="quick-send-btn">50</button>
                </div>
                <button id="resetBtn" class="reset-btn">Reset</button>
                <span id="status" class="status"></span>
            </div>
        </div>
        <div class="key-legend">
            <h3>Key Legend (same key ‚Üí same partition)</h3>
            <div class="legend-items" id="legend"></div>
        </div>
        
        <div class="simulation-area">
            <div class="producer-section">
                <div class="producer-circle">P</div>
                <div class="producer-label">Producer</div>
            </div>
            
            <div class="topic-section">
                <div class="topic-header">Topic: demo</div>
                <div class="partitions" id="partitions">
                    <div class="partition" data-partition="0">
                        <div class="partition-label">P0</div>
                        <div class="partition-count">msgs: 0</div>
                    </div>
                    <div class="partition" data-partition="1">
                        <div class="partition-label">P1</div>
                        <div class="partition-count">msgs: 0</div>
                    </div>
                    <div class="partition" data-partition="2">
                        <div class="partition-label">P2</div>
                        <div class="partition-count">msgs: 0</div>
                    </div>
                </div>
            </div>
            
            <div class="consumer-section">
                <div class="consumer-circle">C</div>
                <div class="consumer-label">consumer</div>
            </div>
        </div>
        
        <div class="info-panels">
            <div class="info-panel">
                <h4>Topic and Partitions</h4>
                <p>All partitions shown are part of the same Topic. A topic is a logical grouping of messages split across partitions for scalability.</p>
            </div>
            <div class="info-panel">
                <h4>Key-based Routing</h4>
                <p>Messages with the same key always route to the same partition. This preserves ordering for that key.</p>
            </div>
            <div class="info-panel">
                <h4>Producer & Consumer</h4>
                <p>One Producer sends messages into the Topic. One Consumer reads from all partitions assigned to it.</p>
            </div>
        </div>
        
            <div class="card fade-in">
                <h2>üì• Consumer <span class="badge consumer">Live Messages</span></h2>
                <div class="tableWrap">
                    <table id="tbl">
                        <thead>
                            <tr>
                                <th>‚è∞ Time</th>
                                <th>üî¢ Partition</th>
                                <th>üìç Offset</th>
                                <th>üîë Key</th>
                                <th>üí¨ Value</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="pager">
                    <label class="muted">Rows: 
                        <select id="pageSize">
                            <option>10</option>
                            <option selected>20</option>
                            <option>50</option>
                            <option>100</option>
                        </select>
                    </label>
                    <button id="prevBtn">‚¨ÖÔ∏è Prev</button>
                    <span id="pageInfo" class="muted"></span>
                    <button id="nextBtn">Next ‚û°Ô∏è</button>
                </div>
                <footer>üìã Latest first. Auto-refresh every 1.5s. Use pagination to browse.</footer>
            </div>
        </div>
    </div>
    <script>
        // Pass configuration to JavaScript
        window.TOPIC = '${TOPIC}';
    </script>
    <script src="/static/js/app.js"></script>
</body>
</html>
